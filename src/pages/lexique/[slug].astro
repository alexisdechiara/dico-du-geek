---
import Lexicon from "../../layouts/Lexicon.astro";
import { fetchAll } from "../../utils/fetchAll";

const alphabet = "abcdefghijklmnopqrstuvwxyz".split("");
const { slug } = Astro.params;

if (!alphabet.some(letter => letter.includes(slug.toLowerCase()))) {
	return Astro.redirect("/lexique");
}

const articles = await fetchAll(slug);
const words = articles.filter((article, index, array) => article.entry.toLowerCase().startsWith(slug) && array.findIndex(a => a.entry === article.entry) === index);
---

<Lexicon>
	<div class="flex flex-col justify-start items-start text-primary min-w-[50%] max-w-screen-lg">
		<h2 class="text-lexicon-letter uppercase -mt-8 font-header">{slug}</h2>
		{
			words.map(word => (
				<a href={`/${word.slug}/definition`} class="text-lexicon-word hover:text-ternary font-header">
					{word.abbreviation ? word.abbreviation + " (" + word.entry + ") " : word.entry}
				</a>
			))
		}
	</div>
</Lexicon>
